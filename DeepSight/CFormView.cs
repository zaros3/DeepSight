using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace DeepSight
{
    public partial class CFormView : Form, CFormInterface
    {
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // private
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // 현재 폼
        private CDefine.FormView m_eCurrentForm = CDefine.FormView.FORM_VIEW_FINAL;
        // 폼 (화면이 전환되는 폼)
        private struct structureForm
        {
            private Form _objForm;
            public Form m_objForm
            {
                get { return _objForm; }
            }
            private CFormInterface _IForm;
            public CFormInterface m_IForm
            {
                get { return _IForm; }
            }

            public structureForm( CFormInterface form )
            {
                this._IForm = form;
                this._objForm = this._IForm as Form;
            }
        }

        private structureForm[] m_stForm;

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 생성자
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public CFormView()
        {   
            InitializeComponent();
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 폼 로드
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        private void CFormView_Load( object sender, EventArgs e )
        {
            // 초기화
            Initialize();
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 폼 종료
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        private void CFormView_FormClosed( object sender, FormClosedEventArgs e )
        {
            // 해제
            DeInitialize();
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 초기화
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public bool Initialize()
        {
            bool bReturn = false;

            do {
                // 폼 초기화
                if( false == InitializeForm() ) break;

                bReturn = true;
            } while( false );

            return bReturn;
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 해제
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public void DeInitialize()
        {
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 폼 초기화
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public bool InitializeForm()
        {
            bool bReturn = false;

            do {
                // 폼 생성
                m_stForm = new structureForm[ ( int )CDefine.FormView.FORM_VIEW_FINAL ];
                // 화면 전환
                SetChangeForm( CDefine.FormView.FORM_VIEW_SETUP );
                SetChangeForm( CDefine.FormView.FORM_VIEW_MAIN );

                bReturn = true;
            } while( false );

            return bReturn;
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 폼 변경
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetChangeForm( CDefine.FormView eForm )
        {   
            do {
                // 현재 폼이 이전 폼과 같으면 건너뜀
                if( m_eCurrentForm == eForm ) break;
                // 현재 폼 Invisible
                if( CDefine.FormView.FORM_VIEW_FINAL != m_eCurrentForm ) {
                    m_stForm[ ( int )m_eCurrentForm ].m_IForm.SetVisible( false );
                    m_stForm[ ( int )m_eCurrentForm ].m_IForm.SetTimer( false );
                }

                // 생성이 되어 있지 않으면 생성
                if( null == m_stForm[ ( int )eForm ].m_IForm ) {
                    switch( eForm ) {
                        case CDefine.FormView.FORM_VIEW_MAIN:
                            m_stForm[ ( int )eForm ] = new structureForm( new CFormMain() as CFormInterface );
                            break;
                        case CDefine.FormView.FORM_VIEW_SETUP:
                            m_stForm[ ( int )eForm ] = new structureForm( new CFormSetup() as CFormInterface );
                            break;
                        case CDefine.FormView.FORM_VIEW_CONFIG:
							m_stForm[ ( int )eForm ] = new structureForm( new CFormConfig() as CFormInterface );
                            break;
						case CDefine.FormView.FORM_VIEW_IO:
							m_stForm[ ( int )eForm ] = new structureForm( new CFormCommunication() as CFormInterface );
							break;
						case CDefine.FormView.FORM_VIEW_REPORT:
							m_stForm[ ( int )eForm ] = new structureForm( new CFormReport() as CFormInterface );
							break;
                        default:
                            break;
                    }
                    // 패널에 생성된 화면 붙임
                    SetFormDockStyle( m_stForm[ ( int )eForm ].m_objForm, this.panelView );
                    m_stForm[ ( int )eForm ].m_IForm.SetVisible( true );
                    m_stForm[ ( int )eForm ].m_IForm.SetTimer( true );
                    m_stForm[ ( int )eForm ].m_IForm.SetChangeLanguage();
                }
                // 생성 되어 있으면 Visible
                else {
                    m_stForm[ ( int )eForm ].m_IForm.SetVisible( true );
                    m_stForm[ ( int )eForm ].m_IForm.SetTimer( true );
                    m_stForm[ ( int )eForm ].m_IForm.SetChangeLanguage();
                }
                
                m_eCurrentForm = eForm;
            } while( false );
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 폼 스타일 달라붙음
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetFormDockStyle( Form objForm, Panel objPanel )
        {
            objForm.Owner = this;
            objForm.TopLevel = false;
            objForm.Dock = DockStyle.Fill;
            objPanel.Controls.Add( objForm );
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 언어 변경
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public bool SetChangeLanguage()
        {
            bool bReturn = false;

            do {
                m_stForm[ ( int )m_eCurrentForm ].m_IForm.SetChangeLanguage();

                bReturn = true;
            } while( false );

            return bReturn;
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 타이머 유무
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetTimer( bool bTimer )
        {
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : Visible 유무
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetVisible( bool bVisible )
        {
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //생성 : 
        //추가 : 
        //목적 : 현재 Form View를 리턴
        //설명 : 
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public CDefine.FormView GetCurrentForm()
        {
            return m_eCurrentForm;
        }

		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//생성 : 
		//추가 : 
		//목적 : 특정 Form View를 리턴
		//설명 : 
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		public Form GetFormView( CDefine.FormView eView )
		{
			Form objForm = null;

			do {
				if( null == m_stForm[ ( int )eView ].m_objForm ) break;
				objForm = m_stForm[ ( int )eView ].m_objForm;
			} while( false );

			return objForm;
		}
    }
}